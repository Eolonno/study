USE master;
CREATE DATABASE YEGOR_UNIVER;
CREATE TABLE Student(
	CardNumber BIGINT NOT NULL PRIMARY KEY,
	LastName NVARCHAR(20) NOT NULL,
	GroupNumber INT NOT NULL
);

ALTER TABLE Student ADD AdmissionDate date;
ALTER TABLE Student DROP column AdmissionDate;

Select * from Student;

INSERT INTO Student 
VALUES 
(98450244, 'Anikeenko', 2),
(34968340, 'Ivanov', 1),
(29385945, 'Fedorov', 1),
(23045892, 'Vok', 2),
(24582054, 'Eremeev', 2),
(70348493, 'Petrov', 1),
(40348493, 'Ïetrov', 1);

SELECT * FROM Student;
SELECT CardNumber, LastName FROM Student;
SELECT COUNT(*) FROM Student;
SELECT * FROM Student WHERE LastName='Anikeenko';
SELECT DISTINCT TOP(2) * FROM Student;

UPDATE Student SET GroupNumber = GroupNumber + 5;

DELETE FROM Student WHERE CardNumber = 40348493;
SELECT * FROM Student;

SELECT DISTINCT * FROM Student WHERE LastName LIKE 'P%';
SELECT DISTINCT * FROM Student WHERE CardNumber BETWEEN 20000000 AND 50000000;
SELECT DISTINCT * FROM Student WHERE GroupNumber IN (1);

DROP TABLE Student;

CREATE TABLE RESULTS(
	ID INT IDENTITY(1,1) PRIMARY KEY,
	STUDENT_NAME NVARCHAR(20) NOT NULL,
	MATH INT,
	KMS INT,
	DB INT,
	AVER_VALUE AS (MATH + KMS + DB) / 3
)

INSERT INTO RESULTS (STUDENT_NAME, MATH, KMS, DB)
VALUES
('STUDENT1', 7, 8, 6),
('STUDENT2', 7, 4, 7),
('STUDENT3', 5, 5, 3),
('STUDENT4', 8, 8, 3),
('STUDENT5', 7, 8, 5),
('STUDENT6', 4, 9, 6),
('STUDENT7', 7, 8, 7),
('STUDENT8', 4, 8, 6);

SELECT * FROM RESULTS;

CREATE TABLE STUDENT (
	CardNumber INT NOT NULL PRIMARY KEY,
	FullName NVARCHAR(100) NOT NULL,
	Sex CHAR CHECK(Sex in ('M', 'F')),
	BirthDate DATE NOT NULL,
	DateOfAdmission DATE NOT NULL
)

INSERT INTO STUDENT 
VALUES
(23843824, 'STUDENT1', 'M', '20020801', '20190712'),
(23843834, 'STUDENT2', 'F', '19990801', '20190712'),
(23843856, 'STUDENT3', 'F', '20030801', '20190712');

SELECT * FROM STUDENT WHERE DATEDIFF(YEAR, BirthDate, DateOfAdmission) >= 18 AND Sex = 'F';

DROP TABLE STUDENT;